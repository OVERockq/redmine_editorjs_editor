/*! For license information please see redmine_editorjs.js.LICENSE.txt */
(()=>{"use strict";var t,e={671:(t,e,n)=>{var r=n(601),o=n(149),i=n(461),a=n(537),u=n(57),s=n(101),c=n(265),l=n(239),f=n(523),v=n(193),h=n(953),d=n(783);function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function y(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return m(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,v={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,v.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=v.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,v.v=r,v.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,v.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(v.n=-1),h(u,s)):v.n=s:v.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=v.n<0)?s:n.call(r,v))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(m(e={},r,function(){return this}),e),f=c.prototype=u.prototype=Object.create(l);function v(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,m(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,m(f,"constructor",c),m(c,"constructor",s),s.displayName="GeneratorFunction",m(c,o,"GeneratorFunction"),m(f),m(f,o,"Generator"),m(f,r,function(){return this}),m(f,"toString",function(){return"[object Generator]"}),(y=function(){return{w:i,m:v}})()}function m(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}m=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){m(t,e,function(t){return this._invoke(e,n,t)})};i("next",0),i("throw",1),i("return",2)}},m(t,e,n,r)}function b(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function w(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(t){b(i,r,o,a,u,"next",t)}function u(t){b(i,r,o,a,u,"throw",t)}a(void 0)})}}function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,S(r.key),r)}}function S(t){var e=function(t){if("object"!=p(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==p(e)?e:e+""}var k=function(){return t=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.options=n,this.editor=null,this.autoSaveTimeout=null,this.init()},e=[{key:"init",value:function(){var t=this,e={holder:this.element,tools:{header:{class:o.A,config:{levels:[1,2,3,4,5,6],defaultLevel:2}},list:{class:i.A,inlineToolbar:!0},checklist:{class:a.A,inlineToolbar:!0},quote:{class:u.A,inlineToolbar:!0},code:s.A,linkTool:{class:c.A,config:{endpoint:"/attachments/link"}},image:{class:l.A,config:{endpoints:{byFile:"/attachments/upload",byUrl:"/attachments/fetch"}}},embed:{class:f.A,config:{services:{youtube:!0,vimeo:!0}}},table:{class:v.A,inlineToolbar:!0},marker:h.A,inlineCode:d.A},data:this.options.initialData||{},onChange:function(){t.onContentChange()},autofocus:!0,placeholder:"내용을 입력하세요..."};this.editor=new r.A(e),this.bindEvents()}},{key:"bindEvents",value:function(){var t=this,e=this.element.closest("form");e&&e.addEventListener("submit",function(){var n=w(y().m(function n(r){return y().w(function(n){for(;;)switch(n.n){case 0:return r.preventDefault(),n.n=1,t.saveContent();case 1:e.submit();case 2:return n.a(2)}},n)}));return function(t){return n.apply(this,arguments)}}()),this.options.autoSave&&this.setupAutoSave()}},{key:"onContentChange",value:(b=w(y().m(function t(){var e,n=this;return y().w(function(t){for(;;)switch(t.n){case 0:this.options.autoSave&&(clearTimeout(this.autoSaveTimeout),this.autoSaveTimeout=setTimeout(function(){n.saveContent()},3e3)),e=new CustomEvent("editorjs:change",{detail:{editor:this}}),this.element.dispatchEvent(e);case 1:return t.a(2)}},t,this)})),function(){return b.apply(this,arguments)})},{key:"saveContent",value:(m=w(y().m(function t(){var e,n;return y().w(function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,this.editor.save();case 1:return e=t.v,this.updateSaveIndicator("저장 중..."),t.n=2,fetch(this.options.saveUrl||window.location.href,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":this.getCsrfToken()},body:JSON.stringify({content:e})});case 2:if(t.v.ok){t.n=3;break}throw new Error("저장 실패");case 3:this.updateSaveIndicator("저장됨"),t.n=5;break;case 4:t.p=4,n=t.v,console.error("저장 오류:",n),this.updateSaveIndicator("저장 실패");case 5:return t.a(2)}},t,this,[[0,4]])})),function(){return m.apply(this,arguments)})},{key:"updateSaveIndicator",value:function(t){var e=document.getElementById("save-indicator");e||((e=document.createElement("div")).id="save-indicator",this.element.parentNode.insertBefore(e,this.element)),e.textContent=t,setTimeout(function(){e.textContent=""},3e3)}},{key:"getCsrfToken",value:function(){var t;return null===(t=document.querySelector('meta[name="csrf-token"]'))||void 0===t?void 0:t.content}},{key:"setupAutoSave",value:function(){var t=this;setInterval(function(){t.saveContent()},3e4)}},{key:"getContent",value:(p=w(y().m(function t(){return y().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,this.editor.save();case 1:return t.a(2,t.v)}},t,this)})),function(){return p.apply(this,arguments)})},{key:"setContent",value:(n=w(y().m(function t(e){return y().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,this.editor.render(e);case 1:return t.a(2)}},t,this)})),function(t){return n.apply(this,arguments)})},{key:"destroy",value:function(){this.editor&&(this.editor.destroy(),this.editor=null),clearTimeout(this.autoSaveTimeout)}}],e&&g(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,p,m,b}();window.RedmineEditorJS=k,document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".editorjs-editor").forEach(function(t){var e={autoSave:"false"!==t.dataset.autosave,saveUrl:t.dataset.saveUrl,initialData:JSON.parse(t.dataset.content||"{}")};new k(t,e)})})}},n={};function r(t){var o=n[t];if(void 0!==o)return o.exports;var i=n[t]={exports:{}};return e[t](i,i.exports,r),i.exports}r.m=e,t=[],r.O=(e,n,o,i)=>{if(!n){var a=1/0;for(l=0;l<t.length;l++){for(var[n,o,i]=t[l],u=!0,s=0;s<n.length;s++)(!1&i||a>=i)&&Object.keys(r.O).every(t=>r.O[t](n[s]))?n.splice(s--,1):(u=!1,i<a&&(a=i));if(u){t.splice(l--,1);var c=o();void 0!==c&&(e=c)}}return e}i=i||0;for(var l=t.length;l>0&&t[l-1][2]>i;l--)t[l]=t[l-1];t[l]=[n,o,i]},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={946:0};r.O.j=e=>0===t[e];var e=(e,n)=>{var o,i,[a,u,s]=n,c=0;if(a.some(e=>0!==t[e])){for(o in u)r.o(u,o)&&(r.m[o]=u[o]);if(s)var l=s(r)}for(e&&e(n);c<a.length;c++)i=a[c],r.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return r.O(l)},n=self.webpackChunkredmine_editorjs_editor=self.webpackChunkredmine_editorjs_editor||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})();var o=r.O(void 0,[487],()=>r(671));o=r.O(o)})();